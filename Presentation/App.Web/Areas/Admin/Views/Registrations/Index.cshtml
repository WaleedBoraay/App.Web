@model App.Web.Areas.Admin.Models.Registrations.RegistrationListModel

<h2>Entity Registrations</h2>

<table class="table table-striped">
    <thead class="table-dark">
        <tr>
            <th>Institution</th>
            <th>License</th>
            <th>Status</th>
            <th>Created On</th>
            <th>Created By</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Registrations)
        {
            <tr>
                <td>@item.InstitutionName</td>
                <td>@item.LicenseNumber</td>
                <td>
                    <span class="badge @(item.Status switch
                          {
                              RegistrationStatus.Draft => "bg-secondary",
                              RegistrationStatus.Submitted => "bg-info",
                              RegistrationStatus.Approved => "bg-success",
                              RegistrationStatus.Rejected => "bg-danger",
                              RegistrationStatus.ReturnedForEdit => "bg-dark",
                              _ => "bg-light text-dark"
                          })">
                    @item.Status
                </span>
            </td>
            <td>@item.CreatedOnUtc</td>
            <td>@item.CreatedByUserName</td>
            <td>
                <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-primary">Details</a>

                    @* Maker actions *@
                @if (Model.IsMaker && item.StatusId == (int)RegistrationStatus.Draft || item.StatusId == (int)RegistrationStatus.ReturnedForEdit)
                    {
                        <form asp-action="Submit" asp-route-id="@item.Id" method="post" style="display:inline">
                            <button type="submit" class="btn btn-success">Submit</button>
                        </form>
                        <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-warning">Edit</a>
                    }

                    @* Checker/Validator actions *@
                    @if (Model.IsChecker && item.StatusId == (int)RegistrationStatus.Submitted)
                    {
                        <form asp-action="Approve" asp-route-id="@item.Id" method="post" style="display:inline">
                            <button type="submit" class="btn btn-success">Validate</button>
                        </form>
                        <form asp-action="ReturnForEdit" asp-route-id="@item.Id" method="post" style="display:inline">
                            <button type="submit" class="btn btn-danger">Return</button>
                        </form>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>

@if (Model.IsMaker)
{
    <a asp-action="Create" asp-controller="Registrations" class="btn btn-success">+ New Registration</a>
}
